{% load static %}
<!DOCTYPE html>
<html lang="it">
<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <title>Gestione Bilancio</title>
</head>
<body class="container mt-5">
    <h1>Gestione Bilancio</h1>

    <form method="post" class="mb-4">
        {% csrf_token %}
        <div class="mb-3">
            <label class="form-label">Tipo</label>
            <select name="tipo" class="form-control" required>
                <option value="entrata">Entrata</option>
                <option value="uscita">Uscita</option>
            </select>
        </div>
        <div class="mb-3">
            <label class="form-label">Data</label>
            <input type="date" name="data" class="form-control" required>
        </div>
        <div class="mb-3">
            <label class="form-label">Descrizione</label>
            <input type="text" name="descrizione" class="form-control" required>
        </div>
        <div class="mb-3">
            <label class="form-label">Importo (€)</label>
            <input type="number" step="0.01" name="importo" class="form-control" required>
        </div>
        <div class="mb-3">
            <label class="form-label">Evento (opzionale)</label>
            <select name="evento" class="form-control">
                <option value="">Nessuno</option>
                {% for evento in eventi.keys %}
                    <option value="{{ evento }}">{{ evento }}</option>
                {% endfor %}
            </select>
        </div>
        <button type="submit" class="btn btn-primary">Aggiungi</button>
    </form>

    <h2>Bilancio Attuale</h2>
    <h3>Entrate</h3>
    <ul class="list-group">
        {% for e in bilancio.entrate %}
            <li class="list-group-item">{{ e.data }} - {{ e.descrizione }}: €{{ e.importo }}</li>
        {% endfor %}
    </ul>

    <h3>Uscite</h3>
    <ul class="list-group">
        {% for u in bilancio.uscite %}
            <li class="list-group-item">{{ u.data }} - {{ u.descrizione }}: €{{ u.importo }}</li>
        {% endfor %}
    </ul>

    <h2>Saldo: €{{ totale_entrate | floatformat:2 }} - €{{ totale_uscite | floatformat:2 }} = €{{ saldo | floatformat:2 }}</h2>

    <a href="{% url 'bilancio_annuale' 2024 %}" class="btn btn-secondary mt-3">Visualizza Bilancio Annuale</a>
</body>
</html>
